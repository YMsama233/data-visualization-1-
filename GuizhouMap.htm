<html>  
    <head>  
        <meta charset="utf-8">  
        <title>贵州地图可视化</title>  
		<style>
            body{
                background-color: #f5f5dca7;
                
            }
			.title{
                color:rgb(30, 6, 53);
                font-size:46px;
                stroke: black;
                text-align: center;
                margin-top: 5px;
                margin-bottom: 10px;
            }
		</style>
    </head> 
	<body>
        <h1 class="title">贵州地图可视化</h1>
        <div id="mysvg"></div>
		<script src="./d3.min.js" charset="utf-8"></script> 
		<script>
			var  width=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)*0.98;
			var  height=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)*0.98;
		
			var svg = d3.select("#mysvg").append("svg")
						.attr("width", width)
						.attr("height", height);
                                                          
            var projection = d3.geoMercator()
                        .center([106.6992,26.7682])
                        .scale(7700)
                        .translate([width/2, height/2]);
		
			//定义地形路径生成器
			var geoPath = d3.geoPath()
						    .projection(projection);	//设定投影

			//颜色比例尺
			var color = d3.schemePaired;           //d3.schemeBlues[9];       //d3.schemeCategory10;
		
			//请求ChinaGeo.json
			d3.json("guizhou.json").then(function(data){           //100000_full.json  A2_100000_full.json
                        
                var scaleColor = d3.scaleOrdinal()
                    .domain(d3.range(data.features.length))
                    .range(d3.schemeCategory10);

            var groups = svg.append("g");
                
            groups.selectAll("path")
                    .data(data.features)
                    .enter()
                    .append("path")
                    .attr("class","province")
                    .attr("stroke","black")
                    .attr("fill",(d,i)=>scaleColor(i%12))
                    .attr("d",d=>geoPath(d));	//使用路径生成器			  
            
            svg.selectAll(".texts")															
                    .data(data.features)								
                    .enter()
                    .append("text")
                    .attr("class", "texts")	
                    .text(function(d){return d.properties.name})
                    .attr("transform", function(d) {
                        var centroid = geoPath.centroid(d),
                            x = centroid[0],
                            y = centroid[1];
                        if(d.properties.name.length<5)
                            return "translate(" + (x-25) + ", " + y + ")";
                        else
                            return "translate(" + (x-80) + ", " + (y+10) + ")";
                    })
                    .attr('fill','white')
                    .attr("stroke","black")
                    .attr("stroke-width","0.05")
                    .attr("font-size","18px");	                        
            });
		</script>	
    </body>  
</html>  